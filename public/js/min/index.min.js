window.addEventListener("load",()=>{"virtualKeyboard"in navigator&&(navigator.virtualKeyboard.overlaysContent=!0);var map=L.map("map").fitWorld();function onLocationFound(e){var radius=e.accuracy;L.marker(e.latlng).addTo(map).bindPopup("You are within "+radius+" meters from this point").openPopup(),L.circle(e.latlng,radius).addTo(map)}function onLocationError(e){alert(e.message)}L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"Â© OpenStreetMap"}).addTo(map),map.locate({setView:!0,maxZoom:16}),map.setView([41.387917,2.169919],16),map.on("locationfound",onLocationFound),map.on("locationerror",onLocationError);let new_routeDATA={active:!0,scrollTop:!0,enableScroll:!1,posY:0},new_routeDOM=document.getElementById("new_route"),new_routeLineDom=new_routeDOM.querySelector(".route_line");const new_route_windowHeight=.15*window.innerHeight||new_routeDOM.getBoundingClientRect().top;let touchFnc_touchStart=(e,el,data)=>{el.style.transition="none",data.posY=e.touches[0].clientY},touchFnc_touchMove=(e,el)=>{e.preventDefault();let touch=e.touches[0];touch.pageY>new_route_windowHeight&&(el.style.top=touch.clientY-25+"px")},touchFnc_touchEnd=(e,el,data,disable=!1)=>{el.style.transition="top 0.3s ease-out",e.preventDefault();let touch=e.changedTouches[0];Math.abs(touch.clientY-data.posY)>50?(data.active&&touch.clientY>data.posY?el.style.top=disable?window.innerHeight+"px":.85*window.innerHeight+"px":el.style.top=.15*window.innerHeight+"px",data.active=!data.active):data.active?el.style.top=.15*window.innerHeight+"px":el.style.top=.85*window.innerHeight+"px"};new_routeLineDom.addEventListener("touchstart",e=>touchFnc_touchStart(e,new_routeDOM,new_routeDATA)),new_routeLineDom.addEventListener("touchmove",e=>touchFnc_touchMove(e,new_routeDOM)),new_routeLineDom.addEventListener("touchend",e=>touchFnc_touchEnd(e,new_routeDOM,new_routeDATA,!1));let new_routeSearchDATA={active:!0,scrollTop:!0,enableScroll:!1,posY:0},new_routeSearchDOM=document.getElementById("new_route_search"),new_routeSearchLineDom=new_routeSearchDOM.querySelector(".route_line");new_routeSearchLineDom.addEventListener("touchstart",e=>touchFnc_touchStart(e,new_routeSearchDOM,new_routeSearchDATA)),new_routeSearchLineDom.addEventListener("touchmove",e=>touchFnc_touchMove(e,new_routeSearchDOM)),new_routeSearchLineDom.addEventListener("touchend",e=>touchFnc_touchEnd(e,new_routeSearchDOM,new_routeSearchDATA,!0));let new_route_btn=document.getElementById("btn_new_route"),preference_btn=document.getElementById("btn_preference"),add_favourite_btn=document.getElementById("btn_add_favourite"),preferenceDOM=document.getElementById("preference"),add_favouriteDOM=document.getElementById("add_favourite");new_route_btn.addEventListener("click",e=>{new_routeSearchDOM.style.transition="top 0.3s ease-in-out",e.preventDefault(),new_routeSearchDOM.style.top=.15*window.innerHeight+"px"}),preference_btn.addEventListener("click",e=>{e.preventDefault(),preferenceDOM.classList.add("active")}),add_favourite_btn.addEventListener("click",e=>{e.preventDefault(),add_favouriteDOM.classList.add("active")})});